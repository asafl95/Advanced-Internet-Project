{"version":3,"sources":["../src/index.js"],"names":["log","err","req","res","next","status","statusCode","INTERNAL_SERVER_ERROR","BAD_REQUEST","body","stack","message","json","assign","pick"],"mappings":";;;;;;kBAKe,YAAsB;AAAA,iFAAJ,EAAI;AAAA,MAAXA,GAAW,QAAXA,GAAW;;AACnC,SAAO,UAACC,GAAD,EAAMC,GAAN,EAAWC,GAAX,EAAgBC,IAAhB,EAAyB;AAAE;AAChC,QAAIC,SAASJ,IAAII,MAAJ,IAAcJ,IAAIK,UAAlB,IAAgC,qBAAWC,qBAAxD;;AAEA,QAAIF,SAAS,qBAAWG,WAAxB,EAAqC;AACnCH,eAAS,qBAAWE,qBAApB;AACD;;AAEDJ,QAAIE,MAAJ,CAAWA,MAAX;;AAEA,QAAMI,OAAO;AACXJ;AADW,KAAb;;AAIA,QAAI,uBAAJ,EAAmB;AACjBI,WAAKC,KAAL,GAAaT,IAAIS,KAAjB;AACD;;AAED,QAAIL,UAAU,qBAAWE,qBAAzB,EAAgD;AAC9CE,WAAKE,OAAL,GAAe,mBAASN,MAAT,CAAf;;AAEA,UAAIL,GAAJ,EAAS;AACPA,YAAI,EAACC,GAAD,EAAMC,GAAN,EAAWC,GAAX,EAAJ;AACD;AACDA,UAAIS,IAAJ,CAASH,IAAT;;AAEA;AACD;;AAED,qBAAEI,MAAF,CAASJ,IAAT,EAAe,iBAAEK,IAAF,CAAOb,GAAP,EAAY,CAAC,SAAD,EAAY,MAAZ,EAAoB,MAApB,EAA4B,MAA5B,CAAZ,CAAf;;AAEAE,QAAIS,IAAJ,CAASH,IAAT;AACD,GA/BD;AAgCD,C;;AAtCD;;;;AACA;;;;AACA;;;;AACA","file":"index.js","sourcesContent":["import httpStatus from 'http-status';\nimport inProduction from 'in-production';\nimport statuses from 'statuses';\nimport _ from 'lodash';\n\nexport default function ({log} = {}) {\n  return (err, req, res, next) => { // eslint-disable-line no-unused-vars\n    let status = err.status || err.statusCode || httpStatus.INTERNAL_SERVER_ERROR;\n\n    if (status < httpStatus.BAD_REQUEST) {\n      status = httpStatus.INTERNAL_SERVER_ERROR;\n    }\n\n    res.status(status);\n\n    const body = {\n      status\n    };\n\n    if (!inProduction) {\n      body.stack = err.stack;\n    }\n\n    if (status >= httpStatus.INTERNAL_SERVER_ERROR) {\n      body.message = statuses[status];\n\n      if (log) {\n        log({err, req, res});\n      }\n      res.json(body);\n\n      return;\n    }\n\n    _.assign(body, _.pick(err, ['message', 'code', 'name', 'type']));\n\n    res.json(body);\n  };\n}"]}